[{"content":"声明 这两天上交所交易系统故障的事件在网上闹的沸沸扬扬，甚至出现了一些阴谋论，说什么放跑空头，内部渗透或是只让大机构交易之类的令人啼笑皆非的发言。今天也趁着有空写一篇文章，站在市场参与者的角度，来分析一下这件事。\n此文初衷是总结时间线，记录历史发生的事件，并且根据发生的事件分析交易系统的技术方案，供有相同爱好的交易所/券商/基金从业人员及专业量化投资者互相交流，若有不妥之处，还请联系指正。\n事件背景 在股市经历了 3 年慢慢熊途，上证指数于 2024年9月18日 最低跌破 2700 点，经济面临较大下行压力的情况下，我方意识到要以雷霆手段打断可能出现的通缩螺旋，而资本市场也许就是最好的突破口。2024年9月24日，央妈、金融监管总局、证监会组团召开新闻发布会，释放了超出市场预期的多项政策，其中的 证券基金保险公司互换便利 和 股票回购增持专项 接近于明牌，就是要直接拉动资本市场，带起财富效应。\n随后我国股市应声而涨，包括 24 号在内仅用 3 个交易日，直接突破 3000 点，各方资金跑步入场，各券商也出现了难得的排队开户的场面，两市成交额在前一周的 18 号还仅有惨淡的 4793 亿，但是随着政策的发布，一举于 25 号突破万亿。\n上交所系统故障时间线 2024年9月27日开盘后，市场气氛热烈，交易量爆炸 9点32分左右，各券商柜台就陆续注意到上交所和深交所的订单回报较平日开盘时段有较大延迟，上交所甚至有订单 ACK 超过 10 秒的情况，随后两个交易所回报时间都似乎逐步恢复正常 9点39分左右，市场上有投资者开始反应，当日上交所订单挂单无响应 9点40分，上交所的沟通群里，开始出现反馈说当日竞价平台回报不正常 接近10点，市场上已经有大量投资者发现挂单没成交，准备撤单后继续挂单，发送撤单请求后，上交所的撤单也没有响应 10点02分左右，许多基金公司的人员反应当日上交所订单大量异常，不少券商柜台的运维人员也反馈，关于上交所订单的延迟/无回报警告正在刷屏，上交所技术公司已知悉此情况，正在排查中 随后，上交所官网发布公告称：“本所关注到，今日开盘后本所股票竞价交易出现成交确认缓慢的异常。本所已在第一时间关注到相关情况，正在就相关原因进行排查。” 10点15分，上证指数开始接近平拉直线 10点18分左右，传言上交所准备进行主备切换 11点13分，有些券商发现上交所订单正在开始恢复逐步消化，有的分区正常，有的分区依旧不正常(比如茅台的行情已恢复，但是招商银行的行情依旧在拉直线) 11点30分，午间休市，上交所系统故障事件变成了热门谈资，随后成为激活沉睡账户、召唤新股民入市的又一重大新闻 12点25分左右，陆续吃完午饭的券商柜台人员发现，上交所 TDGW 在休市期间打印了一些错误日志，并且做了线路的自动切换 13点00分，下午开市，上交所行情不再拉直线，但是回报却较慢 13点08分，上交所行情虽然正常推送，但是成交量却不太正常，看起来行为像是做了流量控制 15点00分，股票收盘，但是各家券商依旧还能收到成交回报 17点30分，上交所的竞价平台依旧在向券商推送订单和成交回报信息 接近18点00分，各家券商陆续得到通知，无需等待上交所的推送结果，当日清算以中证登的结果为准 次日(2024年9月28日)，上交所进行例行全网测试，并通知于2024年9月29日增加一次通关测试，并紧急发布一个 TDGW 新版本 分析 上交所当前架构 相比于上期所 2006年11月3日 上线的自研交易系统 NGES，2024年6月11日 已经升级到了 NGES 3.0；深交所 2016 年6月 正式上线的自研交易系统 STSV5；上交所在 2020 年才刚刚开启自研交易系统 G4 项目；当前上交所使用的交易系统，已经开始逐步向 G4 过渡，例如券商对接部分已于 2022 年开始转向流式报盘，并且新架构、新港股通、新期权等也在开发中，但是竞价平台的核心部分仍然在使用上一代交易系统 NGTS，在结合当前的公开资料和咨询十多年前曾参与开发此系统核心撮合部分的朋友之后，可以画出不完整的架构图:\n问题分析 上交所和深交所的撮合部分都支持分区(上交所称为 set，深交所称为 partition)，即全市场的所有标的分为 n 组，每组放在一个撮合服务中，所以当一个撮合服务出现问题时，并不会影响全市场的标的。而且此架构支持横向扩展的，即随着时代发展，当市场成交量上涨之后，交易所可以在未来增多分区，以减少单个分区上的压力\n关于刚开盘时出现的问题，影响到了竞价平台的所有标的，所以不像是遭遇了某台机器的硬件故障，但具体问题，这里不好猜测 11:13 - 11:30，茅台行情恢复正常而招商银行还在拉直线，这证明了当时上交所至少有一个分区出现了问题，而有些分区则正常运行 13:00 - 14:21，成交情况极不正常，但是系统保持运行，而且行情分时图开起来像是短时间内的分时被拉长了，这里有理由怀疑是为了保证市场运行，上交所进行了某种限流操作，即降低处理效率，让订单排队 15:00 之后，订单和成交还依然保持推送，这里与上一条联系起来看，比较符合逻辑的推测是，虽然进行了限流操作，但是被限流的订单已经通过了进行交易时间段校验的那个服务，堆积到了交易所撮合服务之前 上交所的应对策略推测 这里根据所知的信息，列出个人认为的上交所可能进行的应对策略，并且分析各方法的利弊\n不管分配的流速权，直接对网关发来的报单进行统一的限流拒单，防止订单洪峰冲击核心服务 优势：此方法最简单直接，在刚开盘的高峰期可能出现一些交易所拒单，但是随着订单洪峰的过去，可以保证之后的交易正常，而且可以防止报单响应时间过长 劣势: 这只是对外围进行限流，但并无法保证某个核心撮合分区内的订单不出现大量堆积 在核心撮合服务之前加入限流，直接拒单而不是订单堆积 优势: 可以直接保护撮合服务，防止出现压垮这系统最核心的部分 劣势: 这个方法看起来与前一条类似，但是有个隐藏的难度，那便是 20 多年前启动的 NGTS 项目时用的可不是 Linux，上面的撮合通讯也不是 socket，而是被称为邮箱的机制，如果当前还是和以前一样的话，那么上交所的人不一定改的动这部分代码 扩展分区，在上一小节提到过，深交所和上交所的核心撮合都支持分区，这可以直接提高系统核心的吞吐量 优势: 直接降低每个分区面临的压力，保护系统最核心的部分 劣势: 这里也面临一个问题，对比于深交所已经全面的切到了现代写法的自研系统，上交所的 NGTS 当年用的可不是普通的服务器，而是小型机，现在如果还是这种情况的话，不一定能很快的进行扩展 加快进度，推进 G4 尽快替换当前核心部分 优势: 相比于 2001 年就开始启动立项的 NGTS，参加此系统初期建设的人员早已远离开发一线，例如当前上交技术的话事人王泊，技术公司一些部门的带头大哥都是当年参与其中的中青年，而且 NGTS 所使用的当年算是先进的技术，现在早已变为没有年轻人愿意学习的淘汰技术了，再去大幅度翻新难度极大；而 G4 是上交所完全自研的系统，当前一线人员对代码熟悉 劣势: G4 本身也存在一些问题，0505 之后，也让上交所推进速度有所减慢；而且相比于深交所 16 年上线，由当年就业内知名的深证通话事人邹胜带队开发的深交所自研系统，G4 团队是否有实力在短时间内推进到一个可替换竞价平台核心撮合服务的阶段，还无法确定；另外作为国家级别的交易所，交易系统的更新并不是完全由技术人员来把握的，相比于深交所较为进取的风格，上交所的风格一直是较为保守的 ","permalink":"https://mugglewei.github.io/posts/%E4%B8%8A%E4%BA%A4%E6%89%8020240927%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E6%97%B6%E9%97%B4%E7%BA%BF%E6%A2%B3%E7%90%86%E5%8F%8A%E5%88%86%E6%9E%90/","summary":"声明 这两天上交所交易系统故障的事件在网上闹的沸沸扬扬，甚至出现了一些阴谋论，说什么放跑空头，内部渗透或是只让大机构交易之类的令人啼笑皆非的发言。今天也趁着有空写一篇文章，站在市场参与者的角度，来分析一下这件事。\n此文初衷是总结时间线，记录历史发生的事件，并且根据发生的事件分析交易系统的技术方案，供有相同爱好的交易所/券商/基金从业人员及专业量化投资者互相交流，若有不妥之处，还请联系指正。\n事件背景 在股市经历了 3 年慢慢熊途，上证指数于 2024年9月18日 最低跌破 2700 点，经济面临较大下行压力的情况下，我方意识到要以雷霆手段打断可能出现的通缩螺旋，而资本市场也许就是最好的突破口。2024年9月24日，央妈、金融监管总局、证监会组团召开新闻发布会，释放了超出市场预期的多项政策，其中的 证券基金保险公司互换便利 和 股票回购增持专项 接近于明牌，就是要直接拉动资本市场，带起财富效应。\n随后我国股市应声而涨，包括 24 号在内仅用 3 个交易日，直接突破 3000 点，各方资金跑步入场，各券商也出现了难得的排队开户的场面，两市成交额在前一周的 18 号还仅有惨淡的 4793 亿，但是随着政策的发布，一举于 25 号突破万亿。\n上交所系统故障时间线 2024年9月27日开盘后，市场气氛热烈，交易量爆炸 9点32分左右，各券商柜台就陆续注意到上交所和深交所的订单回报较平日开盘时段有较大延迟，上交所甚至有订单 ACK 超过 10 秒的情况，随后两个交易所回报时间都似乎逐步恢复正常 9点39分左右，市场上有投资者开始反应，当日上交所订单挂单无响应 9点40分，上交所的沟通群里，开始出现反馈说当日竞价平台回报不正常 接近10点，市场上已经有大量投资者发现挂单没成交，准备撤单后继续挂单，发送撤单请求后，上交所的撤单也没有响应 10点02分左右，许多基金公司的人员反应当日上交所订单大量异常，不少券商柜台的运维人员也反馈，关于上交所订单的延迟/无回报警告正在刷屏，上交所技术公司已知悉此情况，正在排查中 随后，上交所官网发布公告称：“本所关注到，今日开盘后本所股票竞价交易出现成交确认缓慢的异常。本所已在第一时间关注到相关情况，正在就相关原因进行排查。” 10点15分，上证指数开始接近平拉直线 10点18分左右，传言上交所准备进行主备切换 11点13分，有些券商发现上交所订单正在开始恢复逐步消化，有的分区正常，有的分区依旧不正常(比如茅台的行情已恢复，但是招商银行的行情依旧在拉直线) 11点30分，午间休市，上交所系统故障事件变成了热门谈资，随后成为激活沉睡账户、召唤新股民入市的又一重大新闻 12点25分左右，陆续吃完午饭的券商柜台人员发现，上交所 TDGW 在休市期间打印了一些错误日志，并且做了线路的自动切换 13点00分，下午开市，上交所行情不再拉直线，但是回报却较慢 13点08分，上交所行情虽然正常推送，但是成交量却不太正常，看起来行为像是做了流量控制 15点00分，股票收盘，但是各家券商依旧还能收到成交回报 17点30分，上交所的竞价平台依旧在向券商推送订单和成交回报信息 接近18点00分，各家券商陆续得到通知，无需等待上交所的推送结果，当日清算以中证登的结果为准 次日(2024年9月28日)，上交所进行例行全网测试，并通知于2024年9月29日增加一次通关测试，并紧急发布一个 TDGW 新版本 分析 上交所当前架构 相比于上期所 2006年11月3日 上线的自研交易系统 NGES，2024年6月11日 已经升级到了 NGES 3.0；深交所 2016 年6月 正式上线的自研交易系统 STSV5；上交所在 2020 年才刚刚开启自研交易系统 G4 项目；当前上交所使用的交易系统，已经开始逐步向 G4 过渡，例如券商对接部分已于 2022 年开始转向流式报盘，并且新架构、新港股通、新期权等也在开发中，但是竞价平台的核心部分仍然在使用上一代交易系统 NGTS，在结合当前的公开资料和咨询十多年前曾参与开发此系统核心撮合部分的朋友之后，可以画出不完整的架构图:","title":"上交所2024-09-27系统故障时间线梳理及分析"},{"content":"近期(2024-06-30)的 A 股又出现一波流畅的下跌走势，关于打击量化的反智言论再次充斥网络，比如\n集思录的帖子: 大家觉得量化是不是直接禁掉得了？ 政法大学刘纪鹏教授建议：暂停量化交易 这些帖子/视频连基本的事实概念都分不清(甚至无法分清量化交易、程序化交易、算法交易和高频交易是不同的概念)，却能言之凿凿的说为了广大投资者应该停止量化交易，实在令人啼笑皆非。而这些本该令人一笑了之的言论却有着大量的拥趸，实在很难令人置之不理。\n所以这篇文章的目的是希望能做一个基础的科普，让大家能够对量化交易有一个简单的认识。\n什么是量化 量化交易，顾名思义，就是以量化的方法来进行交易活动，那么什么是量化呢？其实理工科的学生肯定不会陌生，这里节选 2004 人教版高一物理课本的前言为大家释义：\n一天在树下玩耍，一只熟透了的苹果掉下来，他们就辩论起来：苹果是不是越落越快？不过他们很快就达成一致：是的，苹果越落越快。\n紫珠说：“只说苹果越落越快，没什么了不起，谁能说出苹果下落怎么个越落越快法？”\n黑柱说：“苹果越落越快，就是它的速度正比于落下的距离呗！”\n白胖说：“我看是苹果的速度正比于落下的时间”\n孩子们七嘴八舌，天色已晚，黄娃建议明天到游戏场去做实验，于是大家就散伙回家了。\n\u0026hellip;\u0026hellip;\n第二天，老师带孩子们到实验室，通过‘闪频仪’来记录小球下落每隔一定时间间隔的位置，通过实验数据记录，蓝仔发现规律并说：“其实我是吸取了白胖的想法，速度正比于走过的时间”\n设第 1 秒末速度为 v，初速度为 0，所以平均速度为 v/2，走过的距离为 v/2 * 1 秒\n第 2 秒末速度为 2v，初速度为 v，所以平均速度为 3v/2，走过的距离为 3v/2 * 1 秒\n第 3 秒末速度为 3v，初速度为 2v，所以平均速度为 5v/2，走过的距离为 5v/2 * 1 秒\n依此类推，为了取整数，可令 v = 2，于是小球在相继各秒下落距离之比就是 1:3:5:7:9:\u0026hellip;，如果从零线起算各秒末的总路程，那就是整数的平方 1:4:9:16:25:\u0026hellip;\n\u0026hellip;\u0026hellip;\n“物理学是探索自然界最基本、最普遍规律的科学，物理学的一般探索过程是通过观察和实验积累经验，在经验事实的基础上建立物理模型，提出(往往是猜测出)简洁的物理规律(物理学要求这些规律是定量化的，也就是用公式或数学表达的)，可用它们去预言未知现象，再用新的实验去检验这些物理模型和物理规律，去否定或进一步修正它们。”\n好了，通过上面短文，我们可以知道什么是量化，所以只有你有可量化的策略，并且按照策略去执行，都可以定义为量化交易。并且核心思想也是和物理实验一模一样，先提出假设(定性)，接着将其公式化(量化)，紧接着是实验(回测)，接着根据实验结果否定或进一步修正。\n而且看到这里，相信你也就可以理解，为什么无论是国内的量化私募，还是国外的对冲基金都喜欢数学和物理专业的学生。\n一个简单的量化策略 定性 很好，上面我们已经解释了量化这个词，那么现在我有了一个想法: 买入市场中的蓝筹股，忽略短期波动，始终满仓持有，那么拉长时间看，我能获取超过银行定期存款的利率。\n量化 上面这段假设，我们可以将其理解为定性分析，为了对其进行实验，我们要对其进行定量。首先我们要确定取哪一年的多长的周期的定期存款利率，取次要定义什么是蓝筹股。\n由于定期存款利率是实时变化的，我们不妨取近五年内，十年期国债收益率的月末收盘价最高值，即: 3.6%；接着，我们需要定义蓝筹股，不妨定义如下:\n先确定我们的股票池子:\n非ST、*ST 沪深A股和红筹企业发行的存托凭证 若科创板证券、创业板证券：上市时间超过一年，其他证券：上市时间超过一个季度，除非该证券自上市以来日均总市值排在前 30 位 接着是定义一个筛选蓝筹的方法:\n对样本空间内证券按照过去一年的日均成交金额由高到低排名，剔除排名后 50%的证券 对样本空间内剩余证券，按照过去一年的日均总市值由高到低排名，选取前 300 名的证券作为指数样本 接下来我们需要按固定的周期调整我们的持仓，这里我就定为每年 6 月和 12 月的第二个星期五的下一交易日好了\n回测 我们对上面的策略进行回测，这里暂时忽略手续费和滑点\n起始时间 结束时间 复合年化 夏普 2014-06-27 2024-06-28 7.15% 0.175054 小结 好了，截至目前，我们完成了一个最为简单的策略，他通过买\u0026quot;蓝筹\u0026quot;的方式，获得了超过\u0026quot;定存\u0026quot;的收益。聪明的你应该已经反应过来了，这不就是全仓买入沪深 300 嘛！！！ 是的，你答对了，量化策略其实就在咱们的股民/基民朋友们身边，这里我可以随口说出几个分类：\n按照市值分类: 沪深300，中证500，中证800，中证1000，中证2000 按照行业分类: 中证能源，中证原材料，中证工业指数，中证可选消费，中证主要消费，中证医药卫生，中证信息技术，中证公用事业\u0026hellip;\u0026hellip; 按风格分类: 成长指数，价值指数，红利指数\u0026hellip;\u0026hellip; 除了这些指数类的策略外，其实股民朋友们经常喜欢用的网格策略，集思录网友经常挂在嘴边的双低转债等等，都可以算作是量化交易的范畴。\n算法交易 上面一小节已经讲述了简单策略的开发思路，但是忽略了一个细节，就是执行，即下单。当每当换仓时，我们希望能够以尽可能高的价格卖出需要卖的持仓，以尽可能低的价格买入需要买的持仓；而且通常基金换仓时，会有大量的仓位需要开/平，需要将单子拆的尽可能小，减少对市场的冲击，我们将这个拆弹的买卖步骤称为算法交易。\n现在，让我们来做个上个时代的美梦，你就是利弗莫尔或巴菲特(好吧，这里也许有点不恰当，毕竟利弗莫尔并不会在乎对市场的冲击)，现在你打电话给你的经纪商，要求他买入 20 万股茅台。一个小时之后，你的经纪商给你回电话说，任务完成，持仓成本现在是 k 元/股。那么问题来了，你如何判断你的经纪商和他的执行交易员团队的执行的结果如何呢？\n上面提到尽可能高的价格卖出，尽可能低的价格买入，这里有两个很常用的评价基准，分别为:\nTWAP(Time Weighted Average Price): 时间加权平均价格 VWAP(Volume weighted average price): 成交量加权平均价格 即你只需要按这段时间内的 TWAP 或 VWAP 的价格为基准，对比你的买入成本价，就可以评价你的算法交易的质量了。\n聪明的你读到这，也许又敏锐的注意到：执行下单不一定需要程序进行，由执行交易团队进行也是可以的。所以读到这里我们就可以知道：量化交易不一定是程序化交易，程序化交易只能表示执行阶段。\n这里多提一嘴，其实在上个月，监管的发文当中对算法交易进行了肯定的表述，我个人对此有不同看法，但由于利益相关，这里就不展开说了。\n因子 现在我们已经有了一个大方向上的思路(满仓持有沪深300)，并且也有了评价执行下单效果的方法，接着让我们更进一步，我们是否可以想一个策略，获取比沪深 300 更多的收益呢？比如:\n将沪深 300 按照ROE排序，取排名前 n 个的标的持有 将沪深 300 按照股息率排名，取排民前 n 个的标的持有 将沪深 300 按照市值排名，取排民后 n 个的标的持有 我们当然可以通过回测来观察最终的结果，但是这其中有什么原理吗？ 为什么增加了额外的指标，能够得到更好的结果呢？我们不妨将我们添加的指标称为因子，通常情况下，无论是高频还是低频的策略，我们需要解释我们的因子，也就是找到因子和收益之间的关系，正相关、负相关还是没有关系？不过这里作为一个面向大众的科普文而不是教程，这里就不展开说明了。\n高频交易 现在，要进入最受争议，最让投机亏钱的散户们憎恨的高频交易环节了！那么高频交易和上面说的量化交易有本质的区别吗？并没有，它的方法论完全是一样的，提出假设，验证，再实验；寻找因子，计算因子和收益的相关性，并付诸实际。\n而且高频交易也是一个很广泛的称为，并不是单一的策略类型，甚至有些被大众错误的归类为高频交易的策略，其交易有时候并不频繁，典型的就是各类套利策略，例如\nETF套利 商品的跨品种套利 商品的期现套利 而上述的套利策略，不仅不是有害的，更是市场运行必不可少的存在。\n不过也确实存在极短期内对市场造成冲击的策略，例如仅仅关注市场微观结构，例如针对订单簿不平衡做出吃单动作的策略，他们不同于做市策略，不仅无法提供流动性，还会短期内造成盘口价差扩大。但由于 T+1 的限制，在 A 股股票市场中，做 taker 高频策略的比例并不高，之前可转债疯狂过一阵，不过很快就被限制住了\n总结 截至目前，已经大致介绍了量化交易，可以看出，大部分的中长期策略，并不会对市场造成负面影响，相反，他们会通过基本面因子(例如高股息率，低波动，较高的价值，较高的质量)，持有优秀的企业，并且不受主观情绪的影响。而且国内量化私募卖的最多的一般都是指数增强类产品，这类产品几乎都处于满仓状态，并不存在某些人口中所谓的砸盘和蓄意影响市场。\n那么有人要说了，如果不是量化，那么现在应该怪罪谁？如果有个游戏，你只要参加了就可以赚到几个亿，如果你输了，惩罚是被罚掉几百万，并且退出这个游戏，不过没有性命之忧，如果你有实力参加这个游戏，你玩不玩？\n","permalink":"https://mugglewei.github.io/posts/%E4%BB%80%E4%B9%88%E6%98%AF%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/","summary":"近期(2024-06-30)的 A 股又出现一波流畅的下跌走势，关于打击量化的反智言论再次充斥网络，比如\n集思录的帖子: 大家觉得量化是不是直接禁掉得了？ 政法大学刘纪鹏教授建议：暂停量化交易 这些帖子/视频连基本的事实概念都分不清(甚至无法分清量化交易、程序化交易、算法交易和高频交易是不同的概念)，却能言之凿凿的说为了广大投资者应该停止量化交易，实在令人啼笑皆非。而这些本该令人一笑了之的言论却有着大量的拥趸，实在很难令人置之不理。\n所以这篇文章的目的是希望能做一个基础的科普，让大家能够对量化交易有一个简单的认识。\n什么是量化 量化交易，顾名思义，就是以量化的方法来进行交易活动，那么什么是量化呢？其实理工科的学生肯定不会陌生，这里节选 2004 人教版高一物理课本的前言为大家释义：\n一天在树下玩耍，一只熟透了的苹果掉下来，他们就辩论起来：苹果是不是越落越快？不过他们很快就达成一致：是的，苹果越落越快。\n紫珠说：“只说苹果越落越快，没什么了不起，谁能说出苹果下落怎么个越落越快法？”\n黑柱说：“苹果越落越快，就是它的速度正比于落下的距离呗！”\n白胖说：“我看是苹果的速度正比于落下的时间”\n孩子们七嘴八舌，天色已晚，黄娃建议明天到游戏场去做实验，于是大家就散伙回家了。\n\u0026hellip;\u0026hellip;\n第二天，老师带孩子们到实验室，通过‘闪频仪’来记录小球下落每隔一定时间间隔的位置，通过实验数据记录，蓝仔发现规律并说：“其实我是吸取了白胖的想法，速度正比于走过的时间”\n设第 1 秒末速度为 v，初速度为 0，所以平均速度为 v/2，走过的距离为 v/2 * 1 秒\n第 2 秒末速度为 2v，初速度为 v，所以平均速度为 3v/2，走过的距离为 3v/2 * 1 秒\n第 3 秒末速度为 3v，初速度为 2v，所以平均速度为 5v/2，走过的距离为 5v/2 * 1 秒\n依此类推，为了取整数，可令 v = 2，于是小球在相继各秒下落距离之比就是 1:3:5:7:9:\u0026hellip;，如果从零线起算各秒末的总路程，那就是整数的平方 1:4:9:16:25:\u0026hellip;\n\u0026hellip;\u0026hellip;\n“物理学是探索自然界最基本、最普遍规律的科学，物理学的一般探索过程是通过观察和实验积累经验，在经验事实的基础上建立物理模型，提出(往往是猜测出)简洁的物理规律(物理学要求这些规律是定量化的，也就是用公式或数学表达的)，可用它们去预言未知现象，再用新的实验去检验这些物理模型和物理规律，去否定或进一步修正它们。”\n好了，通过上面短文，我们可以知道什么是量化，所以只有你有可量化的策略，并且按照策略去执行，都可以定义为量化交易。并且核心思想也是和物理实验一模一样，先提出假设(定性)，接着将其公式化(量化)，紧接着是实验(回测)，接着根据实验结果否定或进一步修正。\n而且看到这里，相信你也就可以理解，为什么无论是国内的量化私募，还是国外的对冲基金都喜欢数学和物理专业的学生。\n一个简单的量化策略 定性 很好，上面我们已经解释了量化这个词，那么现在我有了一个想法: 买入市场中的蓝筹股，忽略短期波动，始终满仓持有，那么拉长时间看，我能获取超过银行定期存款的利率。\n量化 上面这段假设，我们可以将其理解为定性分析，为了对其进行实验，我们要对其进行定量。首先我们要确定取哪一年的多长的周期的定期存款利率，取次要定义什么是蓝筹股。\n由于定期存款利率是实时变化的，我们不妨取近五年内，十年期国债收益率的月末收盘价最高值，即: 3.6%；接着，我们需要定义蓝筹股，不妨定义如下:\n先确定我们的股票池子:\n非ST、*ST 沪深A股和红筹企业发行的存托凭证 若科创板证券、创业板证券：上市时间超过一年，其他证券：上市时间超过一个季度，除非该证券自上市以来日均总市值排在前 30 位 接着是定义一个筛选蓝筹的方法:","title":"什么是量化交易-暨驳斥近期网络上关于要打击量化的反智言论"},{"content":"集合\n具有某种特性的事物的整体，或是一些确认对象的汇集\n构成集合的事物或对象称作元素 集合具有无序性，互异性 和 确定性 映射\n\\(X\\)，\\(Y\\)是两个给定的集合，若按照某种规则\\(f\\)，使得对集合\\(X\\)中的每一个元素\\(x\\)，都可以找到集合\\(Y\\)中唯一确定的元素\\(y\\)与之对应，则称\\(f\\)是集合\\(X\\)到集合\\(Y\\)的一个映射，记为:\n$$ \\begin{aligned} f: \u0026amp;X \\rightarrow Y \\newline \u0026amp;x \\mapsto y=f(x) \\end{aligned} $$\n\\(y\\)称为映射f之下\\(x\\)的像 集合\\(X\\)称为映射\\(f\\)的定义域 在映射\\(f\\)之下，\\(X\\)中元素\\(x\\)的像\\(y\\)的全体称为映射的值域 函数\n当\\(X\\)和\\(Y\\)是非空的数集，则映射\\(f: X \\rightarrow Y \\)称为函数\n上面的几个数学定义是高中初始阶段就需要学习的基本概念，一般先给学生们介绍集合及集合间的的关系，接着便是映射和函数，印象中这是十分自然的事情。然而最近在看书的过程中偶然发现，函数这个词最早是由莱布尼茨于1673年提出1，而集合论则要等到200多年后的1874年，康托尔发表论文\u0026quot;关于所有实代数数集的一个性质\u0026quot;2才正式出现。\n那么在集合论出现之前的函数定义是什么样子的？ 函数是如何一步一步的发展成现在的定义的呢？\n函数概念的演化 模糊的概念 历史上早期，有许多数学家，物理学家，天文学家等都用到了与函数类似的概念，只不过没有明确的给出一个定义。\n在1638年伽利略研究同心圆的问题，有两个圆A和B，大圆A的周长是小圆B的两倍，在圆A上任取一点P，过OP做B的割线, 从而将A与B上的每个点对应了起来；同理在B上取一点Q, 用OQ及延长线来割圆A，也可以明确找到A上对应的点。虽然圆A的周长是圆B的两倍，但他们有相同数量的点。伽利略还发现了在正整数和其平方之间标准的一一对应的关系， 这(用现代术语来说)给出了自然数集合N与其真子集的双射。1\n几乎与此同时，1637年笛卡尔在《几何学》中将代数引入了几何学当中。书中提到3:\n这些曲线上的所有的点，必定跟直线上的所有的点具有一种确定的关系，而且这种关系必须用单个的方程来表示。\n\u0026hellip;\n用这种方法，我们总能找到足以决定曲线上所有点的一个方程\n这实质上是在构造曲线的过程中引入了函数的思想，只是当时尚未意识到需要提炼出明确的概念定义。\n1673年, 莱布尼茨在一封信中使用了函数这个词，来表示随曲线变化而改变的量, 例如曲线上一点的坐标，曲线的斜率等14。\n明确的定义 1694年9月2日，约翰.伯努利在写给莱布尼茨的信中，这样描述函数1:\n由变量和常量以某种方式组合形成的另一个量\n1698年, 约翰.伯努利在一篇关于等周长的论文中写下了\u0026quot;坐标函数\u0026quot;5，当时约翰.伯努利正在研究变分法问题，函数作为解决方案出现。到1718年，他将函数描述为6:\n任何由变量和一些常量组成的表达式\n至此，约翰.伯努利对函数进行了明确的定义: 把变量\\(x\\)和常量按任何方式构成的量叫做\u0026quot;\\(x\\)的函数\u0026quot;, 表示为\\(y_x\\)。\n逐步演化 1734年，欧拉写出了一直沿用至今的函数符号:\\(f(x)\\)7。\n1748年，欧拉的《无穷分析引论》出版，本书中欧拉给出函数的定义8:\n一个变量的函数是由变量和数字或常量以任何方式组成的解析表达式\n但是欧拉在书中并未给出解析表达式的明确定义，但基本可理解为通常的四则运算，平方，开方等。欧拉进一步将函数分为不同的类型，如代数函数和超越函数。这本书的意义是非凡的，改变了数学家们看待一些熟悉概念的方式1:\n在欧拉之前，三角量正弦、余弦、正切等被认为是与圆相连的线，而不是函数。\n\u0026hellip;\n是欧拉提出了泛函的观点。\n1755年，欧拉出版了另一本影响深远书《微积分基础》，在这本书中，他以一种完全通用的方式定义了函数，可以说是一个真正现代的函数定义:\n如果一些变量依赖于另一些变量，后者变化时，前面的这些变量也随之变化，那么前面的变量称为后者的函数。该定义适用非常广泛，包含一个变量可以由另一个变量确定的所有方式。因此若\\(x\\)为一个变量，那么以任何方式依赖于\\(x\\)或由它决定的所有的变量都可以称为x的函数。\n1821年，柯西在《分析教程》中，提出了一个定义，使得变量之间的依赖关系成为函数的核心1:\n一些变量，给定其中某一变量的值，就可以推出其他变量的值，则认为这些变量可以由其中某一变量来表达，那么称这此最初变化的变量为自变量，可以用自变量表达的量称为该自变量的函数。\n1822年，傅立叶在《热的分析理论》中给出了定义1:\n通常，函数\\(f(x)\\)表示一系列任意的值或坐标，给定无数个横坐标\\(x\\)的值，就可以得到相同数量的纵坐标\\(f(x)\\)的值。所有的这些值无论是正，负还是未知，我们无须假设这些坐标服从某种规律，他们可以是相互独立的。\n1837年，狄利克雷定义了一个连续函数9:\n每个\\(x\\)对应一个唯一的有限\\(y\\)，当\\(x\\)在区间a到b上连续变化时，若\\(y=f(x)\\)也连续变化，则\\(y\\)称为\\(x\\)在此区间上的连续函数\n1874年，康托尔创立了集合论。\n随着集合论在数学中占据重要的地位之后，维布伦用“集合”和“对应”的概念给出了近代函数定义，通过集合概念，把函数的对应关系、定义域及值域进一步具体化了，且打破了“变量是数”的极限，变量可以是数，也可以是其它对象（点、线、面、体、向量、矩阵等）10。\n1930年新的现代函数定义为，若对集合M的任意元素\\(x\\)，总有集合Ｎ确定的元素\\(y\\)与之对应，则称在集合M上定义一个函数，记为\\(y=f(x)\\)。元素\\(x\\)称为自变量，元素\\(y\\)称为因变量。\n至此，函数从最初模糊的概念，经过几百年的发展，终于成为了我们在中学阶段的教科书中看到的样子。可以看到，函数的定义并非一蹴而就，由某位天才灵感一现而发明，而是随着人类在各种不同学科的发展下，在实践中提出概念，逐步升级，演进的一个过程。\n后记与感悟 搜了一下当年的高中教科书(2004年版人教版数学必修1)，其实在第一章第二节的课后阅读与思考便有介绍函数概念的发展历程，那时初学，应该是没能意识到这件事的趣味与意义，没想到时隔将近二十年之后再次读到，恍然觉得十分有趣。尤其是最后几句，让人颇有感触11:\n函数概念的发展与生产、生活以及科学技术的实际需要紧密相关，而随着研究的深入，函数概念不断得到严谨化、精确化的表达，这与我们学习函数的过程是一样的。\n的确，无论是做研究还是工程技术，在学习知识，掌握技能，产出结果的过程中，我们通常都无法一步到位，一次性做出满意的结果，而是不断的尝试，学习，摸索着前进，将最终的成果变得越来越完善，越来越令人满意。\n引用 O\u0026rsquo;Connor, John J.; Robertson, Edmund F., \u0026ldquo;The function concept\u0026rdquo;, MacTutor History of Mathematics archive, University of St Andrews\u0026#160;\u0026#x21a9;\u0026#xfe0e;\u0026#160;\u0026#x21a9;\u0026#xfe0e;\u0026#160;\u0026#x21a9;\u0026#xfe0e;\u0026#160;\u0026#x21a9;\u0026#xfe0e;\u0026#160;\u0026#x21a9;\u0026#xfe0e;\u0026#160;\u0026#x21a9;\u0026#xfe0e;\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nCantor, Georg (1874), \u0026ldquo;Ueber eine Eigenschaft des Inbegriffes aller reellen algebraischen Zahlen\u0026rdquo;, Journal für die reine und angewandte Mathematik (in German), 1874 (77): 258–262, doi:10.1515/crll.1874.77.258, S2CID 199545885\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n笛卡尔 (2008), \u0026ldquo;笛卡儿几何\u0026rdquo;, ISBN 9787301095508\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nEves dates Leibniz\u0026rsquo;s first use to the year 1694 and also similarly relates the usage to \u0026ldquo;as a term to denote any quantity connected with a curve, such as the coordinates of a point on the curve, the slope of the curve, and so on\u0026rdquo;[Eves, Howard (1990). Foundations and Fundamental Concepts of Mathematics (3rd ed.). Dover. ISBN 0-486-69609-X, p. 234]\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nA P Youschkevitch, The concept of function up to the middle of the 19th century, Arch. History Exact Sci. 16 (1) (1976/77), 37-85\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nEves, Howard (1990). Foundations and Fundamental Concepts of Mathematics (3rd ed.). Dover. ISBN 0-486-69609-X. p. 234\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nFlorian Cajori (1929). A History of Mathematical Notations, reprinted by Dover. ISBN 9780486677668. volume II p. 268\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n欧拉 (2019), \u0026ldquo;无穷分析引论\u0026rdquo;，ISBN 9787560364445\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nMedvedev, Fyodor A. (1991). Scenes from the History of Real Functions. Birkhauser. ISBN 9780817625726. pp. 60–61.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n函数概念的发展与比较，中国数学网\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n数学1 必修 A版, 人民教育出版社，2004，ISBN 7-107-17705-2. p. 31\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://mugglewei.github.io/posts/%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E5%8F%91%E5%B1%95%E6%9C%89%E6%84%9F/","summary":"集合\n具有某种特性的事物的整体，或是一些确认对象的汇集\n构成集合的事物或对象称作元素 集合具有无序性，互异性 和 确定性 映射\n\\(X\\)，\\(Y\\)是两个给定的集合，若按照某种规则\\(f\\)，使得对集合\\(X\\)中的每一个元素\\(x\\)，都可以找到集合\\(Y\\)中唯一确定的元素\\(y\\)与之对应，则称\\(f\\)是集合\\(X\\)到集合\\(Y\\)的一个映射，记为:\n$$ \\begin{aligned} f: \u0026amp;X \\rightarrow Y \\newline \u0026amp;x \\mapsto y=f(x) \\end{aligned} $$\n\\(y\\)称为映射f之下\\(x\\)的像 集合\\(X\\)称为映射\\(f\\)的定义域 在映射\\(f\\)之下，\\(X\\)中元素\\(x\\)的像\\(y\\)的全体称为映射的值域 函数\n当\\(X\\)和\\(Y\\)是非空的数集，则映射\\(f: X \\rightarrow Y \\)称为函数\n上面的几个数学定义是高中初始阶段就需要学习的基本概念，一般先给学生们介绍集合及集合间的的关系，接着便是映射和函数，印象中这是十分自然的事情。然而最近在看书的过程中偶然发现，函数这个词最早是由莱布尼茨于1673年提出1，而集合论则要等到200多年后的1874年，康托尔发表论文\u0026quot;关于所有实代数数集的一个性质\u0026quot;2才正式出现。\n那么在集合论出现之前的函数定义是什么样子的？ 函数是如何一步一步的发展成现在的定义的呢？\n函数概念的演化 模糊的概念 历史上早期，有许多数学家，物理学家，天文学家等都用到了与函数类似的概念，只不过没有明确的给出一个定义。\n在1638年伽利略研究同心圆的问题，有两个圆A和B，大圆A的周长是小圆B的两倍，在圆A上任取一点P，过OP做B的割线, 从而将A与B上的每个点对应了起来；同理在B上取一点Q, 用OQ及延长线来割圆A，也可以明确找到A上对应的点。虽然圆A的周长是圆B的两倍，但他们有相同数量的点。伽利略还发现了在正整数和其平方之间标准的一一对应的关系， 这(用现代术语来说)给出了自然数集合N与其真子集的双射。1\n几乎与此同时，1637年笛卡尔在《几何学》中将代数引入了几何学当中。书中提到3:\n这些曲线上的所有的点，必定跟直线上的所有的点具有一种确定的关系，而且这种关系必须用单个的方程来表示。\n\u0026hellip;\n用这种方法，我们总能找到足以决定曲线上所有点的一个方程\n这实质上是在构造曲线的过程中引入了函数的思想，只是当时尚未意识到需要提炼出明确的概念定义。\n1673年, 莱布尼茨在一封信中使用了函数这个词，来表示随曲线变化而改变的量, 例如曲线上一点的坐标，曲线的斜率等14。\n明确的定义 1694年9月2日，约翰.伯努利在写给莱布尼茨的信中，这样描述函数1:\n由变量和常量以某种方式组合形成的另一个量\n1698年, 约翰.伯努利在一篇关于等周长的论文中写下了\u0026quot;坐标函数\u0026quot;5，当时约翰.伯努利正在研究变分法问题，函数作为解决方案出现。到1718年，他将函数描述为6:\n任何由变量和一些常量组成的表达式\n至此，约翰.伯努利对函数进行了明确的定义: 把变量\\(x\\)和常量按任何方式构成的量叫做\u0026quot;\\(x\\)的函数\u0026quot;, 表示为\\(y_x\\)。\n逐步演化 1734年，欧拉写出了一直沿用至今的函数符号:\\(f(x)\\)7。\n1748年，欧拉的《无穷分析引论》出版，本书中欧拉给出函数的定义8:\n一个变量的函数是由变量和数字或常量以任何方式组成的解析表达式\n但是欧拉在书中并未给出解析表达式的明确定义，但基本可理解为通常的四则运算，平方，开方等。欧拉进一步将函数分为不同的类型，如代数函数和超越函数。这本书的意义是非凡的，改变了数学家们看待一些熟悉概念的方式1:\n在欧拉之前，三角量正弦、余弦、正切等被认为是与圆相连的线，而不是函数。\n\u0026hellip;\n是欧拉提出了泛函的观点。\n1755年，欧拉出版了另一本影响深远书《微积分基础》，在这本书中，他以一种完全通用的方式定义了函数，可以说是一个真正现代的函数定义:\n如果一些变量依赖于另一些变量，后者变化时，前面的这些变量也随之变化，那么前面的变量称为后者的函数。该定义适用非常广泛，包含一个变量可以由另一个变量确定的所有方式。因此若\\(x\\)为一个变量，那么以任何方式依赖于\\(x\\)或由它决定的所有的变量都可以称为x的函数。\n1821年，柯西在《分析教程》中，提出了一个定义，使得变量之间的依赖关系成为函数的核心1:\n一些变量，给定其中某一变量的值，就可以推出其他变量的值，则认为这些变量可以由其中某一变量来表达，那么称这此最初变化的变量为自变量，可以用自变量表达的量称为该自变量的函数。\n1822年，傅立叶在《热的分析理论》中给出了定义1:\n通常，函数\\(f(x)\\)表示一系列任意的值或坐标，给定无数个横坐标\\(x\\)的值，就可以得到相同数量的纵坐标\\(f(x)\\)的值。所有的这些值无论是正，负还是未知，我们无须假设这些坐标服从某种规律，他们可以是相互独立的。","title":"函数概念的演化"}]